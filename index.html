<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="ì°¨ì›ì„ ë„˜ì–´ì„  êµê°, ë©€í‹°ë²„ìŠ¤ í¬ë¦¬ì²˜ ë©: ì‹ í™”ì˜ ì¶©ëŒ. ì„±ì¸ íƒ€ê²Ÿì˜ ê³ í€„ë¦¬í‹° ìˆ˜ì§‘í˜• RPG.">
    <title>Multiverse Creature Lab</title>
    <link rel="icon" href="images/icon_app.svg" type="image/svg+xml">
    <link rel="manifest" href="manifest.json"> <!-- [PWA] -->
    <!-- PortOne SDK (V2) -->
    <!-- Global Override for Guest Button -->
    <style>
        #btn-guest-login {
            display: none !important;
        }
    </style>
    <link rel="stylesheet" href="css/style_v4.css?v=final9999">
</head>

<body>
    <!-- Scripts (Moved to Body for correct execution order) -->
    <!-- Secrets (Optional) -->
    <script src="js/secrets.js?v=9999"></script>

    <!-- Managers -->
    <script src="js/managers/SoundManager.js"></script>

    <!-- Main Entry Point (Module) -->
    <script type="module" src="js/main.js?v=final_fix_v3"></script>
    <script>
        // Disable Right Click for immersion (Optional)
        document.addEventListener('contextmenu', event => event.preventDefault());

        document.addEventListener('DOMContentLoaded', async () => {
            // Wait for Module to load (simple hack: check global)
            const waitForFirebase = () => new Promise(resolve => {
                const check = () => {
                    if (window.firebaseService) resolve();
                    else setTimeout(check, 100);
                };
                check();
            });

            await waitForFirebase();
            console.log("[System] Firebase Service Ready");

            // Init Managers
            if (window.AuthManager) await window.AuthManager.init();
        });
    </script>

    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5874227298630347"
        crossorigin="anonymous"></script>
    <style>
        /* [Critical Fix] Force Expedition Card Layout */
        .expedition-card {
            display: flex !important;
            flex-direction: column !important;
            align-items: flex-start !important;
            justify-content: space-between !important;
            gap: 8px !important;
            padding: 15px !important;
            min-height: 160px !important;
            /* [Mod] Compact Size */
            background: linear-gradient(135deg, rgba(0, 229, 255, 0.15), rgba(0, 0, 0, 0.4)) !important;
            border-radius: 8px !important;
            margin-bottom: 0 !important;
        }

        .expedition-card .exp-icon {
            align-self: flex-start !important;
            /* [Mod] Left align */
            font-size: 2rem !important;
            /* [Mod] Smaller icon */
            margin-bottom: 10px !important;
        }

        /* Grid Layout Fix */
        .grid-expedition {
            display: grid !important;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)) !important;
            gap: 20px !important;
            padding-bottom: 40px !important;
        }

        /* [Visual Upgrade] Tactical Map Effects */
        .tactical-grid {
            background-image:
                linear-gradient(rgba(0, 255, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 255, 0.1) 1px, transparent 1px);
            background-size: 40px 40px;
            box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.8);
            animation: gridPulse 4s infinite alternate;
        }

        @keyframes gridPulse {
            0% {
                opacity: 0.3;
            }

            100% {
                opacity: 0.5;
            }
        }

        .radar-scan {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 150%;
            height: 150%;
            background: conic-gradient(from 0deg, transparent 60%, rgba(0, 255, 255, 0.1));
            transform: translate(-50%, -50%);
            border-radius: 50%;
            animation: radarSpin 4s linear infinite;
            pointer-events: none;
        }

        @keyframes radarSpin {
            from {
                transform: translate(-50%, -50%) rotate(0deg);
            }

            to {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }

            100% {
                transform: translateY(-30px) scale(1.2);
                opacity: 0;
            }
        }

        /* [Visual Revolution] Breathing Animation */
        @keyframes breathe {

            0%,
            100% {
                transform: scaleY(1.00) translateY(0);
            }

            50% {
                transform: scaleY(1.015) translateY(-2px);
            }
        }

        .breathing-effect {
            animation: breathe 4s ease-in-out infinite;
            will-change: transform;
        }
    </style>
    <div id="app-container">
        <!-- ë¡œë¹„ ìºë¦­í„°ëŠ” layout-container ì•ˆì— í†µí•©ë¨ -->

        <!-- [NEW] 2. Floating Header -->
        <header id="game-header" class="glass-panel">
            <div id="user-info-area" style="display:flex; align-items:center; gap:15px;">
                <div style="font-weight:bold; color:var(--accent-primary); font-family:'Orbitron';">DIRECTOR</div>
                <div id="header-user-name">Guest</div>
                <div id="header-user-level"
                    style="background:rgba(255,255,255,0.1); padding:2px 8px; border-radius:4px; font-size:0.85em;">Lv.1
                </div>
            </div>

            <div class="resource-bar">
                <div class="res-item" title="Gold">
                    <span class="res-icon">ğŸ’°</span>
                    <span id="gold-display" class="res-value" data-resource="gold">0</span>
                </div>
                <div class="res-item" title="Gems">
                    <span class="res-icon">ğŸ’</span>
                    <span id="gem-display" class="res-value" data-resource="gem">0</span>
                </div>
                <!-- Energy Removed for cleaner look or keep minimal -->
                <div class="res-item" title="Energy">
                    <span class="res-icon">âš¡</span>
                    <span id="energy-display" class="res-value" data-resource="energy">100/100</span>
                </div>
            </div>
            <div style="display:flex; gap:10px; align-items:center;">
                <button id="btn-toggle-sound" class="cyber-btn small" title="ìŒì†Œê±°">ğŸ”Š</button>
                <button id="btn-open-system" class="cyber-btn small" title="ì‹œìŠ¤í…œ ì„¤ì •">âš™ï¸</button>
                <button id="btn-header-logout" class="cyber-btn small" title="ë¡œê·¸ì•„ì›ƒ"
                    style="background:linear-gradient(135deg, #e74c3c, #c0392b);">ğŸšª</button>
                <button id="btn-lang-toggle" class="cyber-btn small" title="ì–¸ì–´ ë³€ê²½" style="display:none;">ğŸŒ KR</button>
            </div>
        </header>

        <!-- 3. Main Content Area -->
        <main id="main-area">


            <!-- AdSense ë°°ë„ˆ ê´‘ê³  ì˜ì—­ -->
            <div id="ad-banner-top"
                style="width:100%; min-height:90px; background:rgba(0,0,0,0.3); display:flex; justify-content:center; align-items:center; margin-bottom:10px; border-radius:8px;">
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5874227298630347"
                    data-ad-slot="auto" data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>

            <!-- 2.2 Content Viewport -->
            <div id="content-viewport">


                <!-- PANELS -->


                <!-- ì‹¤ì œ ì»¨í…ì¸  (í™”ë©´ë³„ ì „í™˜) -->
                <!-- ê¸°ì¡´ì˜ 3ë‹¨ ë ˆì´ì•„ì›ƒì€ 'ê´€ë¦¬(Home)' í™”ë©´ì˜ ì¼ë¶€ë¡œ ì¬ë°°ì¹˜í•˜ê±°ë‚˜
                     ê° íƒ­ë³„ë¡œ ë‹¤ë¥¸ ë·°ë¥¼ ë³´ì—¬ì£¼ë„ë¡ ìˆ˜ì •í•´ì•¼ í•¨.
                     ì¼ë‹¨ ê¸°ì¡´ êµ¬ì¡°ë¥¼ 'panel-home' ì•ˆì— ë„£ì–´ì„œ í˜¸í™˜ì„± ìœ ì§€ ì‹œë„. -->

                <!-- Main Home Layout (Lobby) -->
                <div id="content-home" class="layout-dashboard tab-content active">
                    <!-- 1. ì™¼ìª½: ë³´ìœ  í¬ë¦¬ì²˜ -->
                    <!-- 1. ì™¼ìª½: ë³´ìœ  í¬ë¦¬ì²˜ / ë„ê° -->
                    <div id="left-panel" class="glass-panel">
                        <!-- Panel Tabs -->
                        <div class="panel-tabs"
                            style="display:flex; border-bottom:1px solid rgba(255,255,255,0.1); margin-bottom:10px;">
                            <button id="tab-btn-inventory" class="tab-btn active"
                                style="flex:1; padding:10px; background:none; border:none; color:white; border-bottom:2px solid var(--accent-cyan); cursor:pointer;">ë³´ìœ 
                                (Inventory)</button>
                            <button id="tab-btn-archive" class="tab-btn"
                                style="flex:1; padding:10px; background:none; border:none; color:#888; border-bottom:2px solid transparent; cursor:pointer;">ë„ê°
                                (Archive)</button>
                        </div>

                        <div id="creature-controls" style="display:flex; gap:5px; margin-bottom:10px; flex-wrap:wrap;">
                            <select id="sort-order" class="cyber-select" style="flex:1; min-width:80px;">
                                <option value="rarity_desc">ë“±ê¸‰ìˆœ â–¼</option>
                                <option value="level_desc">ë ˆë²¨ìˆœ â–¼</option>
                                <option value="world">ì‹ í™”ë³„ (World)</option>
                                <option value="recent">ìµœì‹ ìˆœ</option>
                            </select>
                            <select id="filter-rarity" class="cyber-select" style="flex:1; min-width:80px;">
                                <option value="all">ì „ì²´ ë“±ê¸‰</option>
                                <option value="UR">UR</option>
                                <option value="SSR">SSR</option>
                                <option value="SR">SR</option>
                                <option value="Normal">N/R (ì¼ë°˜)</option>
                            </select>
                        </div>
                        <div style="display:flex; justify-content:flex-end; margin-bottom:10px;">
                            <button id="btn-auto-compose" class="cyber-btn small" title="ìë™ í•©ì„±"
                                style="font-size:0.8rem;">âš¡ ìë™ í•©ì„±</button>
                        </div>

                        <!-- Archive Stats (Visible only in Archive Tab) -->
                        <div id="archive-stats"
                            style="display:none; padding:5px 10px; font-size:0.85em; color:var(--accent-cyan); text-align:center; background:rgba(0,0,0,0.2); border-radius:4px; margin-bottom:10px;">
                            ìˆ˜ì§‘ í˜„í™© ë¡œë”©ì¤‘...
                        </div>

                        <div id="creature-list" class="scroll-custom"></div>

                        <!-- 2. ì¤‘ì•™: ìƒì„¸/ë©”ì¸ -->
                        <div id="center-panel" class="glass-panel">
                            <div class="panel-header">
                                <h3>í¬ë¦¬ì²˜ ì •ë³´</h3>
                            </div>
                            <div id="detail-panel">
                                <p class="placeholder-text">í¬ë¦¬ì²˜ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                            </div>
                        </div>

                        <!-- 3. ì˜¤ë¥¸ìª½: ë¡œê·¸ -->
                        <div id="right-panel" class="glass-panel">
                            <div class="panel-header">
                                <h3>í™œë™ ë¡œê·¸</h3>
                            </div>
                            <div id="log-content" class="scroll-custom"
                                style="height:200px; font-size:0.8rem; color:#8b949e; padding:10px;"></div>
                        </div>

                        <!-- 4. ë¡œë¹„ ìºë¦­í„° -->
                        <div id="lobby-character-panel">
                            <div id="lobby-character-wrapper">
                                <img id="lobby-character-img" class="breathing-effect"
                                    src="images/creature_god_zeus.jpg" alt="Lobby Character">
                                <!-- touch-zones are removed because main.js uses coordinate calculation on the image itself -->
                                <div id="lobby-speech-bubble"><span id="lobby-speech-text">...</span>
                                </div>
                                <div id="lobby-buttons"
                                    style="position:absolute; bottom:20px; right:20px; display:flex; flex-direction:column; gap:10px; z-index:100;">
                                    <button class="cyber-btn small" id="btn-lobby-manage" style="opacity:0.9;">âš™ï¸
                                        ê´€ë¦¬</button>
                                    <button class="cyber-btn" id="btn-lobby-date"
                                        style="background: linear-gradient(135deg, #e91e63, #ad1457);">ğŸ¥‚ ë°ì´íŠ¸</button>
                                    <button class="cyber-btn" id="btn-outpost-claim"
                                        style="background: linear-gradient(135deg, #f39c12, #d35400); position:relative;">
                                        ğŸ’° ì •ì°° ë³´ìƒ <span id="outpost-badge"
                                            style="display:none; position:absolute; top:-5px; right:-5px; width:10px; height:10px; background:red; border-radius:50%;"></span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- [Feature Views] -->

                    <!-- 1. Summon View -->
                    <div id="content-summon" class="feature-view tab-content">
                        <div class="glass-panel full-height">
                            <div class="panel-header">
                                <h3>ì°¨ì› ì†Œí™˜ (SUMMON)</h3>
                            </div>
                            <div
                                style="padding:20px; text-align:center; display:flex; flex-direction:column; align-items:center; height:calc(100% - 60px); justify-content:center;">
                                <!-- Result Area -->
                                <div id="summon-result"
                                    style="flex:1; width:100%; display:flex; justify-content:center; align-items:center; flex-direction:column; min-height:200px;">
                                    <div class="placeholder-text">ì°¨ì›ì˜ í‹ˆìƒˆì—ì„œ í¬ë¦¬ì²˜ë¥¼ ì†Œí™˜í•˜ì„¸ìš”.</div>
                                </div>

                                <!-- Buttons -->
                                <div
                                    style="display:flex; justify-content:center; gap:20px; margin-top:20px; width:100%; flex-wrap:wrap;">
                                    <div
                                        style="background:rgba(255,255,255,0.05); padding:20px; border-radius:12px; border:1px solid #444;">
                                        <h4 style="margin:0 0 15px 0; color:var(--text-primary); font-size:1.1em;">ì¼ë°˜ ì†Œí™˜
                                            (Gold)</h4>
                                        <div style="display:flex; gap:10px;">
                                            <button id="btn-summon-n1" class="cyber-btn" style="padding:10px 20px;">
                                                <div style="font-size:0.9em;">1íšŒ</div>
                                                <div style="font-size:0.8em; color:#f1c40f;">300 G</div>
                                            </button>
                                            <button id="btn-summon-n10" class="cyber-btn action"
                                                style="padding:10px 20px;">
                                                <div style="font-size:0.9em;">10+1íšŒ</div>
                                                <div style="font-size:0.8em; color:#f1c40f;">3,000 G</div>
                                            </button>
                                        </div>
                                    </div>
                                    <div
                                        style="background:rgba(171,71,188,0.1); padding:20px; border-radius:12px; border:1px solid var(--accent-purple);">
                                        <h4 style="margin:0 0 15px 0; color:var(--accent-purple); font-size:1.1em;">í”„ë¦¬ë¯¸ì—„
                                            ì†Œí™˜
                                            (Gem)</h4>
                                        <div style="display:flex; gap:10px;">
                                            <button id="btn-summon-p1" class="cyber-btn" style="padding:10px 20px;">
                                                <div style="font-size:0.9em;">1íšŒ</div>
                                                <div style="font-size:0.8em; color:var(--accent-cyan);">1 ğŸ’</div>
                                            </button>
                                            <button id="btn-summon-p10" class="cyber-btn action"
                                                style="padding:10px 20px;">
                                                <div style="font-size:0.9em;">10+1íšŒ</div>
                                                <div style="font-size:0.8em; color:var(--accent-cyan);">10 ğŸ’</div>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- 2. Team View -->
                    <div id="content-team" class="feature-view tab-content">
                        <div class="glass-panel full-height">
                            <div class="panel-header">
                                <h2>íƒì‚¬ëŒ€ ê´€ë¦¬ (TEAM)</h2>
                            </div>
                            <div style="padding:15px; flex:1; overflow-y:auto;">
                                <div
                                    style="display:flex; gap:10px; margin-bottom:15px; border-bottom:1px solid #444; padding-bottom:10px;">
                                    <button class="cyber-btn small deck-tab active" data-deck="main">ëŒ€í‘œ ë±</button>
                                    <button class="cyber-btn small deck-tab" data-deck="sub1">ë³´ì¡° ë± 1</button>
                                    <button class="cyber-btn small deck-tab" data-deck="defense">ë°©ì–´ ë±</button>
                                </div>
                                <div
                                    style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                                    <span id="label-active-deck"
                                        style="color:var(--accent-primary); font-size:0.9em;">í˜„ì¬:
                                        ëŒ€í‘œ ë±</span>
                                    <button id="btn-set-main-deck" class="cyber-btn small active-btn">ëŒ€í‘œ íŒ€ìœ¼ë¡œ ì„¤ì •</button>
                                </div>
                                <div id="deck-slots"
                                    style="display:flex; justify-content:space-around; padding:20px; background:rgba(0,0,0,0.2); border-radius:8px; margin-bottom:20px;">
                                </div>
                                <h4 style="margin-top:20px; border-bottom:1px solid #444; padding-bottom:5px;">ë³´ìœ  í¬ë¦¬ì²˜
                                </h4>
                                <div id="deck-pool"
                                    style="display:grid; grid-template-columns:repeat(auto-fill, minmax(75px, 1fr)); gap:10px; margin-top:10px; max-height:450px; overflow-y:auto; padding:5px;">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 3. Battle View -->
                    <div id="content-battle" class="feature-view tab-content">
                        <div class="glass-panel full-height">
                            <div class="panel-header">
                                <h2>ì „íˆ¬ ì‹œë®¬ë ˆì´ì…˜ (BATTLE)</h2>
                            </div>
                            <div style="padding:20px; text-align:center; overflow-y: auto; height:calc(100% - 60px);">
                                <div
                                    style="background:rgba(255,112,67,0.05); padding:20px; border-radius:12px; margin-bottom:25px; border:1px solid rgba(255,112,67,0.2);">
                                    <h3 id="stage-title"
                                        style="font-size:1.5rem; margin-bottom:10px; color:var(--accent-orange);">Stage
                                        1
                                    </h3>
                                    <div id="stage-info" style="margin-bottom:10px; color:#aaa; font-size:0.9em;">ë¡œë“œ
                                        ì¤‘...
                                    </div>
                                    <div id="stage-rewards" style="margin-bottom:20px; color:#ddd; font-size:0.95em;">ë¡œë“œ
                                        ì¤‘...</div>
                                    <div style="display:flex; justify-content:center; gap:20px; margin-bottom:15px;">
                                        <button id="btn-prev-stage" class="cyber-btn small">&lt;</button>
                                        <button id="btn-start-stage" class="cyber-btn action"
                                            style="padding:15px 35px; font-size:1.15rem;">âš”ï¸ ì‘ì „ ê°œì‹œ</button>
                                        <button id="btn-next-stage" class="cyber-btn small">&gt;</button>
                                    </div>
                                    <div style="display:flex; align-items:center; justify-content:center; gap:10px;">
                                        <span style="font-size:0.9em; color:#aaa;">ìë™ ì „íˆ¬:</span>
                                        <select id="select-auto-battle" class="cyber-select"
                                            style="padding:5px; font-size:0.9em;">
                                            <option value="off">êº¼ì§</option>
                                            <option value="repeat">í˜„ì¬ ìŠ¤í…Œì´ì§€ ë°˜ë³µ</option>
                                            <option value="advance">ë‹¤ìŒ ìŠ¤í…Œì´ì§€ ì§„í–‰</option>
                                        </select>
                                    </div>
                                </div>
                                <hr style="border:0; border-top:1px solid #444; margin:30px 0;">
                                <div class="pvp-section">
                                    <h3 style="color:var(--accent-gold); margin-bottom:15px;">ğŸ›¡ï¸ PVP ì•„ë ˆë‚˜</h3>
                                    <div style="display:flex; gap:10px; margin-bottom:15px;">
                                        <input type="text" id="pvp-search-input" placeholder="ë¼ì´ë²Œ ê²€ìƒ‰..."
                                            class="cyber-input" style="flex:1;">
                                        <button id="btn-pvp-search" class="cyber-btn">ê²€ìƒ‰</button>
                                    </div>
                                    <div id="pvp-user-list"
                                        style="min-height:150px; background:rgba(0,0,0,0.2); padding:10px; border-radius:12px; border:1px solid #333;">
                                    </div>
                                    <div style="margin-top:15px; display:flex; justify-content:center; gap:10px;">
                                        <button id="btn-pvp-start" class="cyber-btn small">ëŒ€ì „ ì½”ë“œ ì…ë ¥</button>
                                        <input type="text" id="pvp-friend-code" class="cyber-input"
                                            style="width:100px; display:none;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 4. Expedition View -->
                    <div id="content-expedition" class="feature-view tab-content"
                        style="height:100%; display:none; flex-direction:column;">
                        <div class="glass-panel full-height"
                            style="display:flex; flex-direction:column; overflow:hidden;">
                            <div class="panel-header" style="flex:0 0 auto;">
                                <h2>íƒì‚¬ ë³¸ë¶€ (EXPEDITION)</h2>
                            </div>
                            <div style="flex:1; display:flex; flex-direction:column; min-height:0; overflow:hidden;">
                                <!-- Top: Tactical Map & Log -->
                                <div
                                    style="flex:0 0 25%; display:flex; border-bottom:1px solid #444; min-height: 180px;">
                                    <!-- Map Area -->
                                    <div
                                        style="flex:1.5; position:relative; overflow:hidden; border-right:1px solid #444; background:#0f0f15;">
                                        <div id="map-background" class="tactical-grid" style="width:100%; height:100%;">
                                        </div>
                                        <div class="radar-scan"></div>

                                        <div id="map-units-container"
                                            style="position:absolute; top:0; left:0; width:100%; height:100%;"></div>
                                        <div
                                            style="position:absolute; top:10px; left:10px; font-size:0.8rem; color:#00e5ff; font-family:'Orbitron'; text-shadow:0 0 5px #00e5ff;">
                                            TACTICAL MAP VIEW
                                        </div>
                                    </div>

                                    <!-- Log Area -->
                                    <div
                                        style="flex:1; display:flex; flex-direction:column; background:rgba(0,0,0,0.5);">
                                        <div
                                            style="padding:10px; border-bottom:1px solid #333; font-size:0.9rem; color:var(--accent-cyan);">
                                            ğŸ“¡ ì‹¤ì‹œê°„ í†µì‹  ë¡œê·¸
                                        </div>
                                        <div id="expedition-log-display" class="scroll-custom"
                                            style="flex:1; padding:10px; overflow-y:auto; font-size:0.8rem; color:#aaa; font-family:'Courier New', monospace;">
                                            <div style="opacity:0.5;">No signal...</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Bottom: Active List & Zones -->
                                <!-- Bottom: Active List & Zones (Horizontal Split) -->
                                <div
                                    style="flex:1; display:flex; flex-direction:row; padding:0; overflow:hidden; min-height:0;">
                                    <!-- Left: Active Expeditions (30%) -->
                                    <div
                                        style="flex:0 0 30%; display:flex; flex-direction:column; padding:15px; border-right:1px solid #444; background:rgba(0,0,0,0.1); overflow-y:auto;">
                                        <div
                                            style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; flex-shrink:0;">
                                            <h3 style="margin:0; font-size:1rem; color:var(--text-primary);">ì§„í–‰ ì¤‘ì¸ íƒì‚¬
                                            </h3>
                                            <label style="font-size:0.85rem; color:#aaa; cursor:pointer;">
                                                <input type="checkbox" id="check-auto-repeat"
                                                    style="vertical-align:middle;"> ìë™ ë°˜ë³µ
                                            </label>
                                        </div>
                                        <div id="active-expedition-list"
                                            style="display:flex; flex-direction:column; gap:10px;">
                                            <!-- Active items will go here -->
                                            <div style="text-align:center; padding:20px; color:#666; font-size:0.9rem;">
                                                ì§„í–‰ ì¤‘ì¸ íƒì‚¬ê°€ ì—†ìŠµë‹ˆë‹¤.
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Right: Zone Selection (70%) -->
                                    <div
                                        style="flex:1; display:flex; flex-direction:column; padding:15px; overflow-y:auto;">
                                        <h3
                                            style="margin:0 0 15px 0; font-size:1rem; color:var(--text-primary); flex-shrink:0;">
                                            íƒì‚¬ êµ¬ì—­ ì„ íƒ
                                        </h3>
                                        <div id="expedition-list" class="grid-expedition"
                                            style="display:grid; grid-template-columns:repeat(auto-fill, minmax(260px, 1fr)); gap:15px; padding-bottom:20px;">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 5. Research View -->
                    <div id="content-research" class="feature-view tab-content">
                        <div class="glass-panel full-height">
                            <div class="panel-header">
                                <h2>ì—°êµ¬ì†Œ (LAB)</h2>
                            </div>
                            <div id="facility-list" style="padding:15px; overflow-y:auto; height:calc(100% - 60px);">
                            </div>
                        </div>
                    </div>

                    <!-- 6. Mission View -->
                    <div id="content-mission" class="feature-view tab-content">
                        <div class="glass-panel full-height">
                            <div class="panel-header">
                                <h2>ë¯¸ì…˜ ì„¼í„° (MISSION)</h2>
                            </div>
                            <div style="padding: 15px; overflow-y:auto; height:calc(100% - 60px);">
                                <h3 style="border-bottom: 1px solid #444; padding-bottom: 8px;">ì¼ì¼ ë¯¸ì…˜</h3>
                                <div id="daily-quest-list" style="margin-bottom: 25px;"></div>
                                <h3 style="border-bottom: 1px solid #444; padding-bottom: 8px;">ì—…ì </h3>
                                <div id="achievement-list"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 7. Shop View -->
                    <div id="content-shop" class="feature-view tab-content">
                        <div class="glass-panel full-height">
                            <div class="panel-header">
                                <h2>ë³´ê¸‰ì†Œ (SHOP)</h2>
                            </div>
                            <div style="padding:15px; overflow-y:auto; height:calc(100% - 60px);">
                                <div id="ad-banner"
                                    style="height:80px; background:linear-gradient(45deg, #ff00cc, #333399); margin-bottom:20px; border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:bold; color:white;">
                                    âœ¨ ê´‘ê³  ë³´ìƒ: 50 ì ¬</div>
                                <div id="shop-list"
                                    style="display:grid; grid-template-columns:repeat(auto-fill, minmax(140px, 1fr)); gap:15px;">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 8. Prestige View -->
                    <div id="content-prestige" class="feature-view tab-content">
                        <div class="glass-panel full-height">
                            <div class="panel-header">
                                <h2 style="color:var(--accent-purple);">ì°¨ì› ë„ì•½ (PRESTIGE)</h2>
                            </div>
                            <div style="padding: 20px; text-align: center; overflow-y:auto; height:calc(100% - 60px);">
                                <div
                                    style="background: rgba(171,71,188,0.1); border: 1px solid var(--accent-purple); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                                    <div style="font-size: 0.9em; color: var(--accent-purple); margin-bottom: 10px;">ëˆ„ì ëœ
                                        ì°¨ì›
                                        ì¡°ê°</div>
                                    <div id="prestige-shards-total"
                                        style="font-size: 2.2rem; font-weight: bold; color: #fff;">0</div>
                                    <div style="font-size: 0.8em; opacity: 0.7; margin-top: 5px;">ì˜ˆì •: <span
                                            id="prestige-shards-pending" style="color:var(--accent-gold);">0</span>
                                    </div>
                                </div>
                                <button id="btn-execute-prestige" class="cyber-btn"
                                    style="width: 100%; padding: 15px; background: linear-gradient(135deg, #6a1b9a, #ab47bc); margin-bottom: 20px;">ğŸŒ€
                                    ì°¨ì› ë„ì•½ ì‹¤í–‰</button>
                                <div class="prestige-upgrades-grid"
                                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px;">
                                </div>
                            </div>
                        </div>
                    </div>

                </div> <!-- End of content-viewport -->
        </main>

        <!-- 3. Bottom Dock (Navigation) -->
        <nav id="bottom-dock" class="glass-panel">
            <button id="tab-home" class="nav-item active">
                <span class="icon">ğŸ </span> <span>ë©”ì¸</span>
            </button>
            <button id="tab-summon" class="nav-item">
                <span class="icon">ğŸ”®</span> <span>ì†Œí™˜</span>
            </button>
            <button id="tab-team" class="nav-item">
                <span class="icon">ğŸ‘¥</span> <span>íŒ€</span>
            </button>
            <button id="tab-battle" class="nav-item">
                <span class="icon">âš”ï¸</span> <span>ì‘ì „</span>
            </button>
            <button id="tab-expedition" class="nav-item">
                <span class="icon">ğŸš€</span> <span>íƒì‚¬</span>
            </button>
            <button id="tab-research" class="nav-item">
                <span class="icon">ğŸ§ª</span> <span>ì—°êµ¬</span>
            </button>
            <button id="tab-mission" class="nav-item">
                <span class="icon">ğŸ“</span> <span>ë¯¸ì…˜</span>
            </button>
            <button id="tab-shop" class="nav-item">
                <span class="icon">ğŸ›’</span> <span>ìƒì </span>
            </button>
        </nav>
    </div> <!-- End of App Container -->

    <!-- =========================================
         GLOBAL OVERLAYS (Outside App Container)
         ========================================= -->

    <!-- Debug Cheat Button -->
    <div id="dev-controls" style="position: fixed; bottom: 10px; right: 10px; z-index: 9999; display: none;">
        <button id="devFillResources" style="padding: 10px; background: red; color: white;">[DEV] ìì› ì±„ìš°ê¸°</button>
    </div>

    <!-- Tutorial Overlay -->
    <div id="tutorial-overlay" style="display: none;">
        <div id="tutorial-msg-box">
            <p id="tutorial-text">íŠœí† ë¦¬ì–¼ ì•ˆë‚´ ë¬¸êµ¬</p>
            <button id="btn-skip-tutorial">íŠœí† ë¦¬ì–¼ ê±´ë„ˆë›°ê¸°</button>
        </div>
    </div>

    <!-- Custom Confirmation Modal -->
    <div id="custom-modal-overlay"
        style="display: none; z-index: 20000; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); justify-content: center; align-items: center;">
        <div id="custom-modal-box">
            <p id="custom-modal-msg">ì•Œë¦¼</p>
            <div id="custom-modal-buttons" style="margin-top: 20px; display: flex; justify-content: center; gap: 10px;">
                <button id="btn-modal-yes"
                    style="background:#2ecc71; color:white; border:none; padding:8px 20px; border-radius:4px; cursor:pointer;">í™•ì¸</button>
                <button id="btn-modal-no"
                    style="background:#e74c3c; color:white; border:none; padding:8px 20px; border-radius:4px; cursor:pointer;">ì·¨ì†Œ</button>
            </div>
        </div>
    </div>

    <!-- Creature Detail Modal -->
    <div id="creature-detail-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content glass-panel detail-modal-content">
            <div id="modal-detail-body">
                <!-- Content injected by CreatureView.js -->
            </div>
        </div>
    </div>

    <!-- Expedition Selective Modal -->
    <div id="expedition-select-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content glass-panel">
            <div class="detail-header"
                style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h3 style="margin:0;">íƒì‚¬ëŒ€ í¸ì„±</h3>
                <button id="btn-close-exp-modal" class="cyber-btn small" style="font-size:1.5rem;">Ã—</button>
            </div>
            <p style="color:var(--text-secondary); margin-bottom:15px; font-size:0.9rem;">íƒì‚¬ë¥¼ ë³´ë‚¼ í¬ë¦¬ì²˜ë¥¼ ì„ íƒí•˜ì„¸ìš”.</p>
            <div id="exp-creature-list"
                style="display:grid; grid-template-columns:repeat(auto-fill, minmax(80px, 1fr)); gap:10px; max-height:400px; overflow-y:auto; padding:10px; background:rgba(0,0,0,0.2); border-radius:8px;">
                <!-- Creatures injected by ExpeditionView.js -->
            </div>
        </div>
    </div>

    <!-- Battle Overlay -->
    <div id="battle-overlay">
        <div id="battle-header">
            <div>TURN 1</div>
            <div>BATTLE IN PROGRESS</div>
        </div>
        <div id="battle-stage">
            <!-- Entities injected by JS -->
        </div>
        <div id="battle-controls"
            style="display:flex; gap:15px; justify-content:center; padding:20px; background:rgba(0,0,0,0.5);">
            <button class="cyber-btn" id="btn-stop-battle"
                style="background:linear-gradient(135deg, #e74c3c, #c0392b);">ì‘ì „ ì¤‘ì§€</button>
            <div
                style="display:flex; align-items:center; gap:10px; background:rgba(255,255,255,0.1); padding:0 15px; border-radius:5px; border:1px solid rgba(255,255,255,0.2);">
                <span style="font-size:0.85em; color:#aaa;">ìë™ ì „íˆ¬:</span>
                <select id="battle-auto-select" class="cyber-select"
                    style="padding:5px; font-size:0.85em; background:transparent; color:#fff; border:none;">
                    <option value="off">êº¼ì§</option>
                    <option value="repeat">ë°˜ë³µ</option>
                    <option value="advance">ì§„í–‰</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Auth / Login Overlay -->
    <div id="login-overlay"
        style="display: flex; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999999; justify-content: center; align-items: center; flex-direction: column;">

        <!-- Logo Area -->
        <h1
            style="font-family: 'Orbitron', sans-serif; color: #58a6ff; font-size: 2.5rem; margin-bottom: 20px; text-shadow: 0 0 20px rgba(88, 166, 255, 0.6); text-align:center;">
            MULTIVERSE<br><span style="font-size:0.6em; letter-spacing:5px; color:#fff;">CREATURE LAB</span>
        </h1>

        <!-- Auth Card -->
        <div id="auth-card" class="glass-panel"
            style="width: 90%; max-width: 400px; padding: 0; overflow: hidden; border: 1px solid var(--border-tech); box-shadow: 0 0 50px rgba(0,0,0,0.8);">

            <!-- Tabs -->
            <div style="display:flex; border-bottom:1px solid var(--border-tech);">
                <button id="tab-login-mode" class="auth-tab active" data-i18n="auth.login"
                    style="flex:1; padding:15px; background:transparent; border:none; color:white; font-family:'Orbitron'; cursor:pointer; font-size:1.1rem;">ë¡œê·¸ì¸</button>
                <button id="tab-signup-mode" class="auth-tab" data-i18n="auth.signup"
                    style="flex:1; padding:15px; background:rgba(255,255,255,0.05); border:none; color:#888; font-family:'Orbitron'; cursor:pointer; font-size:1.1rem;">íšŒì›ê°€ì…</button>
            </div>

            <!-- Form Body -->
            <div style="padding: 30px;">
                <!-- Persona Selection Area -->
                <div style="display:flex; gap:20px; margin-bottom:20px; align-items: flex-start;">
                    <!-- Avatar Column -->
                    <div style="flex:1; text-align:center;">
                        <div id="selected-avatar-preview"
                            style="width:100px; height:100px; border-radius:12px; border:2px solid var(--accent-cyan); margin:0 auto 10px; overflow:hidden; background:#000; box-shadow: 0 0 15px var(--accent-cyan);">
                            <img id="avatar-preview-img" src="images/creatures/asgard/creature_valkyrie.png"
                                style="width:100%; height:100%; object-fit:cover;">
                        </div>
                        <div id="avatar-options" style="display:flex; justify-content:center; gap:5px; flex-wrap:wrap;">
                            <img src="images/creatures/asgard/creature_valkyrie.png" class="avatar-option selected"
                                data-id="director_vesper" title="Dr. Vesper"
                                style="width:40px; height:40px; border-radius:50%; border:2px solid transparent; cursor:pointer;">
                            <img src="images/creature_god_zeus.jpg" class="avatar-option" data-id="director_kael"
                                title="Commander Kael"
                                style="width:40px; height:40px; border-radius:50%; border:2px solid transparent; cursor:pointer;">
                            <img src="images/creatures/abyss/creature_void_emperor.png" class="avatar-option"
                                data-id="director_zero" title="Subject Zero"
                                style="width:40px; height:40px; border-radius:50%; border:2px solid transparent; cursor:pointer;">
                            <img src="images/creatures/wild/creature_creator_gaia.png" class="avatar-option"
                                data-id="director_eos" title="Lady Eos"
                                style="width:40px; height:40px; border-radius:50%; border:2px solid transparent; cursor:pointer;">
                        </div>
                    </div>

                    <!-- Bio Column -->
                    <div style="flex:1.5; text-align:left; border-left:1px solid #333; padding-left:15px;">
                        <h3 id="persona-name" style="color:white; margin:0; font-family:'Orbitron';">Dr. Vesper
                        </h3>
                        <div id="persona-title"
                            style="color:var(--accent-magenta); font-size:0.8rem; margin-bottom:10px;"></div>
                        <div id="persona-bio" style="font-size:0.85rem; color:#aaa; line-height:1.4;"></div>
                    </div>
                </div>

                <!-- Input Fields -->
                <div style="display:flex; flex-direction:column; gap:15px;">
                    <input type="text" id="auth-username" data-i18n="auth.id_placeholder" placeholder="ì ‘ì† ID (Username)"
                        class="cyber-input" style="padding:12px; border-radius:4px; font-size:1rem;">

                    <input type="password" id="auth-password" data-i18n="auth.pw_placeholder"
                        placeholder="ë¹„ë°€ë²ˆí˜¸ (Passphrase)" class="cyber-input"
                        style="padding:12px; border-radius:4px; font-size:1rem;">

                    <input type="password" id="auth-confirm-password" data-i18n="auth.confirm_placeholder"
                        placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸ (Confirm)" class="cyber-input"
                        style="padding:12px; border-radius:4px; font-size:1rem; display:none;">
                </div>

                <!-- Login Options -->
                <div
                    style="display:flex; justify-content:space-between; margin-top:10px; font-size:0.85rem; color:#ccc;">
                    <label style="display:flex; align-items:center; gap:5px; cursor:pointer;">
                        <input type="checkbox" id="check-remember-me" style="accent-color:var(--accent-cyan);"> ì•„ì´ë”” ì €ì¥
                    </label>
                    <label style="display:flex; align-items:center; gap:5px; cursor:pointer;">
                        <input type="checkbox" id="check-auto-login" checked style="accent-color:var(--accent-cyan);">
                        ìë™ ë¡œê·¸ì¸
                    </label>
                </div>

                <!-- Action Button -->
                <button id="btn-auth-action" class="cyber-btn action" data-i18n="auth.btn_login"
                    style="width:100%; padding:15px; margin-top:25px; font-size:1.1rem; border-radius:4px;">ì ‘ì†
                    ê°œì‹œ (LOGIN)</button>

                <!-- Google ë¡œê·¸ì¸ (Firebase) -->
                <div style="margin-top:15px; text-align:center;">
                    <div style="display:flex; align-items:center; gap:10px; margin-bottom:10px;">
                        <hr style="flex:1; border:0; border-top:1px solid #444;">
                        <span style="color:#888; font-size:0.85rem;">ë˜ëŠ”</span>
                        <hr style="flex:1; border:0; border-top:1px solid #444;">
                    </div>

                    <!-- Guest Login Button -->
                    <button id="btn-guest-login" class="cyber-btn"
                        style="width:100%; padding:12px; margin-bottom:10px; background:#333; color:#aaa; border:1px solid #555; display:flex; align-items:center; justify-content:center; gap:10px;">
                        <span>ğŸ‘¤ ê²ŒìŠ¤íŠ¸ë¡œ ì‹œì‘í•˜ê¸° (Guest Start)</span>
                    </button>

                    <button id="btn-google-login" class="cyber-btn"
                        style="width:100%; padding:12px; background:linear-gradient(135deg, #4285F4, #34A853); display:flex; align-items:center; justify-content:center; gap:10px;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="white">
                            <path
                                d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                            <path
                                d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                            <path
                                d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                            <path
                                d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                        </svg>
                        <span>Googleë¡œ ë¡œê·¸ì¸ (í´ë¼ìš°ë“œ ì €ì¥)</span>
                    </button>
                    <p style="margin-top:8px; font-size:0.75rem; color:#666;">â˜ï¸ ë¡œê·¸ì¸í•˜ë©´ ì§„í–‰ìƒí™©ì´ í´ë¼ìš°ë“œì— ì €ì¥ë©ë‹ˆë‹¤</p>
                </div>

                <div id="auth-message"
                    style="margin-top:15px; text-align:center; color:#e74c3c; font-size:0.9rem; min-height:20px;">
                </div>
            </div>
        </div>
    </div> <!-- End of login-overlay -->

    <!-- System Modal (MUST be outside login-overlay) -->
    <div id="system-modal-overlay"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000000000; justify-content: center; align-items: center;">
        <div class="glass-panel"
            style="width: 90%; max-width: 600px; height: 70%; display: flex; flex-direction: column; padding: 0;">
            <!-- Header -->
            <div
                style="padding: 15px; border-bottom: 1px solid var(--border-tech); display: flex; justify-content: space-between; align-items: center;">
                <h2 style="margin: 0; color: var(--accent-cyan); font-family: 'Orbitron';">ì‹œìŠ¤í…œ ì„¤ì • (SYSTEM)</h2>
                <button id="btn-close-system"
                    style="background: none; border: none; color: #888; font-size: 1.5rem; cursor: pointer;">&times;</button>
            </div>

            <!-- Tabs -->
            <div style="display: flex; background: rgba(0,0,0,0.3);">
                <button class="system-tab active" data-tab="notice"
                    style="flex: 1; padding: 15px; background: transparent; border: none; color: white; cursor: pointer; border-bottom: 2px solid var(--accent-cyan);">ê³µì§€ì‚¬í•­</button>
                <button class="system-tab" data-tab="coupon"
                    style="flex: 1; padding: 15px; background: transparent; border: none; color: #888; cursor: pointer; border-bottom: 2px solid transparent;">ğŸ
                    ì¿ í°</button>
                <button class="system-tab" data-tab="contact"
                    style="flex: 1; padding: 15px; background: transparent; border: none; color: #888; cursor: pointer; border-bottom: 2px solid transparent;">1:1
                    ë¬¸ì˜</button>
            </div>

            <!-- Content -->
            <div style="flex: 1; overflow-y: auto; padding: 20px;">

                <!-- Notice View -->
                <div id="view-notice">
                    <div class="notice-item"
                        style="border-bottom: 1px dashed #444; padding-bottom: 15px; margin-bottom: 15px;">
                        <h3 style="color: #f1c40f; margin-bottom: 5px;">[ì—…ë°ì´íŠ¸] v2.1.0 ì•ŒíŒŒ ë¦´ë¦¬ì¦ˆ</h3>
                        <div style="font-size: 0.8rem; color: #888; margin-bottom: 10px;">2025-12-12</div>
                        <p style="font-size: 0.9rem; line-height: 1.4;">
                            - UI ì „ë©´ ê°œí¸: í…Œí¬-ëŠì™€ë¥´ ìŠ¤íƒ€ì¼ ì ìš©<br>
                            - ì‹ ê·œ ê¸°ëŠ¥: ì§€íœ˜ê´€(Director) í˜ë¥´ì†Œë‚˜ ì‹œìŠ¤í…œ<br>
                            - ëª¨ë°”ì¼ ìµœì í™” ì™„ë£Œ
                        </p>
                    </div>
                </div>

                <!-- Coupon View -->
                <div id="view-coupon" style="display: none;">
                    <p style="color: #8b949e; margin-bottom: 20px;">ë³´ìƒ ì½”ë“œë¥¼ ì…ë ¥í•˜ì—¬ íŠ¹ë³„ ë³´ìƒì„ ë°›ìœ¼ì„¸ìš”!</p>
                    <div style="display:flex; gap:10px; margin-bottom:20px;">
                        <input type="text" id="coupon-code-input" placeholder="ì½”ë“œ ì…ë ¥" style="flex:1; padding:12px 15px; background:rgba(0,0,0,0.4); border:1px solid var(--accent-primary); 
                                   border-radius:8px; color:#fff; font-size:1rem; text-transform:uppercase;">
                        <button id="btn-redeem-coupon" class="cyber-btn" style="padding:12px 25px;">
                            ğŸ ì‚¬ìš©
                        </button>
                    </div>
                    <div id="coupon-result" style="padding:15px; border-radius:8px; display:none;"></div>
                    <div style="margin-top:20px; padding:15px; background:rgba(255,255,255,0.05); border-radius:8px;">
                        <h4 style="color:var(--accent-gold); margin-bottom:10px;">ğŸ“‹ ì‚¬ìš© ê°€ëŠ¥í•œ ì½”ë“œ</h4>
                        <ul style="color:#aaa; font-size:0.9rem; line-height:1.8;">
                            <li><code style="background:#333; padding:2px 8px; border-radius:4px;">YESOL2025</code>
                                - UR/SSR/SR í¬ë¦¬ì²˜ 20ë§ˆë¦¬ ì§€ê¸‰</li>
                            <li><code style="background:#333; padding:2px 8px; border-radius:4px;">GOLDRICH</code> -
                                ê³¨ë“œ 100,000 ì§€ê¸‰</li>
                            <li><code style="background:#333; padding:2px 8px; border-radius:4px;">GEMMASTER</code>
                                - ì ¬ 500 ì§€ê¸‰</li>
                        </ul>
                    </div>
                </div>

                <!-- Contact View -->
                <div id="view-contact" style="display: none;">
                    <p style="color: #8b949e; margin-bottom: 20px;">ë²„ê·¸ ì œë³´ë‚˜ ê±´ì˜ì‚¬í•­ì„ ë³´ë‚´ì£¼ì„¸ìš”. 24ì‹œê°„ ë‚´ì— ë‹µë³€í•´ ë“œë¦½ë‹ˆë‹¤.</p>
                </div>

            </div>
        </div>
    </div>

    <!-- í¬ë¦¬ì²˜ ìƒì„¸ ì •ë³´ ëª¨ë‹¬ -->
    <div id="creature-detail-modal" class="modal-overlay" style="display:none;">
        <div class="modal-content glass-panel" style="max-width:450px; width:90%;">
            <button id="btn-close-detail" class="modal-close-btn">âœ•</button>
            <div id="modal-detail-body">
                <!-- ë™ì ìœ¼ë¡œ ë‚´ìš© ì±„ì›Œì§ -->
            </div>
        </div>
    </div>

    <!-- Date Course Modal -->
    <div id="date-select-modal" class="modal-overlay" style="display:none;">
        <div class="modal-content glass-panel" style="max-width:400px; text-align:center;">
            <div class="detail-header" style="margin-bottom:20px;">
                <h3>ğŸ¥‚ ë°ì´íŠ¸ ì½”ìŠ¤ ì„ íƒ</h3>
                <button onclick="document.getElementById('date-select-modal').style.display='none'"
                    class="cyber-btn small">Ã—</button>
            </div>
            <div id="date-course-list" style="display:flex; flex-direction:column; gap:10px;">
                <!-- Injected by JS -->
            </div>
        </div>
    </div>

    <!-- [NEW] Nickname Modal -->
    <div id="nickname-modal" class="modal-overlay" style="display:none; z-index: 10002;">
        <div class="modal-content glass-panel" style="max-width:350px; text-align:center;">
            <h3 style="color:var(--accent-cyan); margin-bottom:15px;">ë‹‰ë„¤ì„ ì„¤ì •</h3>
            <p style="font-size:0.9rem; color:#aaa; margin-bottom:20px;">
                ìµœì´ˆ 1íšŒ, ì‚¬ìš©í•  ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.<br>
                (Google ê³„ì •ê³¼ ì—°ë™ë©ë‹ˆë‹¤)
            </p>
            <input type="text" id="nickname-input" class="cyber-input" placeholder="í•œê¸€/ì˜ë¬¸ 2~8ì"
                style="width:80%; margin-bottom:20px; text-align:center;">
            <button id="btn-nickname-confirm" class="cyber-btn" style="width:100%;">í™•ì¸</button>
        </div>
    </div>

    <!-- Config & Secrets (Local Development Only) -->
    <script src="js/secrets.js?v=9999" onerror="console.warn('secrets.js not found. AI features disabled.')"></script>

    <script src="js/debug_overlay.js?v=9999"></script>
    <script type="module" src="js/main.js?v=9999"></script>

    <!-- [PWA] Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js?v=9999')
                    .then(reg => console.log('[PWA] ServiceWorker registered:', reg.scope))
                    .catch(err => console.log('[PWA] ServiceWorker registration failed:', err));
            });
        }
    </script>

    <!-- [URGENT RESTORE] Auto-restore all creatures on load -->
    <script src="js/restore_creatures.js?v=urgent_fix_v1"></script>
    <!-- TEMPORARY ENABLED: í¬ë¦¬ì²˜ ëª©ë¡ ë³µêµ¬ìš© (2026-01-06) -->

    <!-- [NEW] Custom Confirm Modal (General Purpose) -->
    <div id="custom-modal-overlay" class="modal-overlay" style="display:none; z-index:20000;">
        <div class="modal-content glass-panel" style="max-width:350px; text-align:center;">
            <p id="custom-modal-msg" style="margin-bottom:20px; font-size:1.1rem; line-height:1.5;">
                í™•ì¸ ë©”ì‹œì§€
            </p>
            <div style="display:flex; gap:10px; justify-content:center;">
                <button id="btn-modal-yes" class="cyber-btn danger" style="flex:1;">ì˜ˆ (Yes)</button>
                <button id="btn-modal-no" class="cyber-btn" style="flex:1; background:#444;">ì•„ë‹ˆì˜¤ (No)</button>
            </div>
        </div>
    </div>

    <!-- =========================
         SETTINGS MODAL
         ========================= -->
    <div id="modal-settings" class="modal-overlay" style="display:none;">
        <div class="modal-content glass-panel" style="max-width:400px; text-align: left;">
            <div class="modal-header">
                <h2>ì‹œìŠ¤í…œ ì„¤ì •</h2>
                <button class="btn-close-modal">âŒ</button>
            </div>
            <div class="modal-body" style="display:flex; flex-direction:column; gap:20px;">

                <div class="setting-group">
                    <h4 style="margin-bottom:10px; color:var(--accent-primary);">ì˜¤ë””ì˜¤</h4>
                    <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:10px;">
                        <span>ë°°ê²½ìŒì•… (BGM)</span>
                        <input type="range" id="slider-bgm-volume" min="0" max="1" step="0.1" value="0.5"
                            style="width:50%;">
                    </div>
                    <div style="display:flex; align-items:center; justify-content:space-between;">
                        <span>íš¨ê³¼ìŒ (SFX)</span>
                        <input type="range" id="slider-sfx-volume" min="0" max="1" step="0.1" value="0.7"
                            style="width:50%;">
                    </div>
                </div>

                <div class="setting-group">
                    <h4 style="margin-bottom:10px; color:var(--accent-primary);">ê³„ì •</h4>
                    <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:10px;">
                        <span>ë‹‰ë„¤ì„</span>
                        <div style="display:flex; gap:5px;">
                            <input type="text" id="input-setting-nickname" class="cyber-input" style="width:100px;"
                                readonly>
                            <button id="btn-change-nickname" class="cyber-btn small">ë³€ê²½</button>
                        </div>
                    </div>
                    <div style="display:flex; justify-content:center; margin-top:10px;">
                        <button id="btn-setting-logout" class="cyber-btn danger" style="width:100%;">ë¡œê·¸ì•„ì›ƒ</button>
                    </div>
                </div>

                <div class="setting-group" style="font-size:0.8em; color:#888; text-align:center; margin-top:20px;">
                    <p>Version 0.4.0 (Beta)</p>
                    <p>Multiverse Creature Lab</p>
                </div>

            </div>
        </div>
    </div>
</body>

</html>